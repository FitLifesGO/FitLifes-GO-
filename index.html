<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>FitLifes¬°GO! ‚Äî Tu App de Fitness & Dieta</title>
  <meta name="description" content="Aplicaci√≥n de fitness con seguimiento diario, planes, dietas y asistente." />

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/a2d9b5f2d5.js" crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

  <style>
    /* ==========================
        Estilos principales
       ========================== */
    :root{
      --bg: #0f1724; /* dark */
      --card: #0b1220;
      --muted: #9aa4b2;
      --accent: #2dd4bf; /* mint */
      --accent-2: #f59e0b; /* orange */
      --glass: rgba(255,255,255,0.03);
      --radius: 12px;
      --ff: 'Inter',system-ui,Arial;
    }
    [data-theme="light"]{
      --bg: #f6f8fa;
      --card: #ffffff;
      --muted: #4b5563;
      --accent: #059669;
      --accent-2: #ea580c;
      --glass: rgba(2,6,23,0.03);
    }

    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0; font-family:var(--ff); background:var(--bg); color:var(--muted);
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      transition:background .3s, color .3s;
    }

    header{display:flex;align-items:center;justify-content:space-between;padding:18px 28px;background:linear-gradient(180deg, rgba(0,0,0,0.06), transparent);backdrop-filter: blur(6px);position:sticky;top:0;z-index:40}
    .brand{display:flex;gap:12px;align-items:center;color:var(--accent)}
    .brand img { height: 30px; width: auto; }
    .brand h1{margin:0;font-size:1.1rem;color:inherit}

    .desktop-nav{display:flex;gap:12px;align-items:center}
    .desktop-nav a{color:var(--muted);text-decoration:none;padding:8px 12px;border-radius:8px}
    .desktop-nav a:hover{background:var(--glass);color:inherit}

    .desktop-controls{display:flex;gap:10px;align-items:center}
    .btn{background:var(--accent);color:#042027;padding:8px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:600; text-decoration:none; display:inline-block; text-align:center;}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)}

    #mobile-menu-btn { display: none; }

    main{padding:28px;max-width:1200px;margin:18px auto}

    /* Hero */
    .hero{display:grid;grid-template-columns:1fr 420px;gap:18px;align-items:center;margin-bottom:22px}
    .hero .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:28px;border-radius:var(--radius)}
    .hero h2{margin:0 0 10px 0;color:var(--accent);font-size:1.8rem}
    .hero p{margin:0 0 18px 0;color:var(--muted)}
    .hero-buttons{display:flex;gap:10px;margin-top:12px}

    /* Grid for sections */
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
    .col-8{grid-column:span 8}
    .col-4{grid-column:span 4}
    
    /* Cards */
    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 6px 22px rgba(2,6,23,0.25)}
    h3{margin-top:0;color:var(--muted)}

    .badge{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(0,0,0,0.06);font-weight:600}
    .chart-wrap{width:140px;height:140px;display:flex;align-items:center;justify-content:center}
    .form-row{display:flex;gap:8px;margin-bottom:10px}
    input,select{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit; width:100%;}
    .form-row input, .form-row select {flex: 1;}

    /* Chat assistant */
    .chat{display:flex;flex-direction:column;height:320px}
    .chat .messages{flex:1;overflow:auto;padding:10px;display:flex;flex-direction:column;gap:8px}
    .msg{max-width:70%;padding:10px;border-radius:10px}
    .msg.user{align-self:flex-end;background:var(--accent);color:#002024}
    .msg.bot{align-self:flex-start;background:rgba(255,255,255,0.03)}

    /* Tutorial Step Styling */
    .tutorial-step {
        border-left: 4px solid var(--accent);
        padding: 10px 15px;
        margin-bottom: 15px;
        background: var(--glass);
        border-radius: 8px;
    }
    .tutorial-step strong {
        color: var(--accent);
    }
    
    footer{padding:28px;text-align:center;color:var(--muted);margin-top: 30px; border-top: 1px solid var(--glass);}
    footer p {margin: 5px 0;}
    footer strong {color: var(--accent);}

    /* ====================
        NUEVO: Mejoras Responsive
       ==================== */
    @media (max-width:900px){
      header { padding: 15px; }
      main { padding: 15px 15px 80px 15px; } /* Espacio para la nav m√≥vil fija */
      
      .desktop-nav, .desktop-controls { display: none; }
      #mobile-menu-btn { display: block; }
      .hero{grid-template-columns:1fr}
      .grid{display:block}
      .col-8,.col-4{grid-column:auto}
      .hero-buttons { flex-direction: column; }
      .hero-buttons .btn { width: 100%; }
      .diet-list { flex-direction: column; }
      .diet-card { flex-direction: column; text-align: center; }
      .chart-wrap { margin-bottom: 10px; }
      .form-row { flex-direction: column; }
      .card[data-aos] { margin-top: 14px; }
      
      /* Ocultar las secciones largas por defecto en m√≥vil, excepto la activa */
      #diario, #planes, #dietas, #contacto, #creditos, #tutorial { display: none; }
      .mobile-active-section { display: block !important; }

      /* Barrita de navegaci√≥n inferior para m√≥vil */
      #mobile-nav-tabs {
          position: fixed;
          bottom: 0;
          left: 0;
          width: 100%;
          background: var(--card);
          border-top: 1px solid var(--glass);
          display: flex;
          justify-content: space-around;
          padding: 8px 0;
          z-index: 50;
          box-shadow: 0 -4px 10px rgba(0,0,0,0.1);
      }
      .tab-btn {
          background: none;
          border: none;
          color: var(--muted);
          cursor: pointer;
          font-size: 0.7rem;
          padding: 5px;
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 3px;
          font-weight: 600;
      }
      .tab-btn i {
          font-size: 1.2rem;
      }
      .tab-btn.active {
          color: var(--accent);
      }
      
    }
    /* Estilos de Modales y otros se mantienen... */
    .wizard-step{display:none;}
    .wizard-step.active{display:block;}
    .wizard-nav{display:flex;justify-content:space-between;margin-top:20px;}
    .wizard-options .option{ display:block; padding:12px 18px; border:1px solid var(--glass); border-radius:10px; margin-bottom:10px; cursor:pointer; }
    .wizard-options .option:hover{background:var(--glass);}
    .wizard-options .option.selected{border-color:var(--accent); color:var(--accent);}
    .modal-overlay { /* ... */ }
    .modal-overlay.visible { /* ... */ }
    /* ... (resto de estilos de modales y componentes) */
  </style>
</head>
<body data-theme="dark">
  <header>
    <div class="brand">
        <img src="logos/FitLifesGoLOGO.png" alt="FitLifes¬°GO! Logo">
        <h1>FitLifes¬°GO!</h1>
    </div>
    
    <nav class="desktop-nav">
      <a href="#inicio">Inicio</a>
      <a href="#tutorial">Gu√≠a R√°pida</a>
      <a href="#planes">Planes</a>
      <a href="#dietas">Dietas</a>
      <a href="#diario">Diario</a>
      <a href="#contacto">Contacto</a>
      <a href="#creditos">Cr√©ditos</a>
    </nav>
    <div class="desktop-controls">
      <button id="themeToggle" class="btn secondary" title="Cambiar tema"><i class="fa-solid fa-moon"></i></button>
      <button id="openRegister" class="btn">Mi Perfil</button>
    </div>

    <button id="mobile-menu-btn" class="btn secondary"><i class="fa-solid fa-bars"></i></button>

  </header>

  <main>
    <section class="hero" id="inicio">
      <div class="card">
        <h2>Entrena con prop√≥sito, come con intenci√≥n</h2>
        <p>Planes personalizados, calculadoras, seguimiento y un sistema visual de dietas con gr√°ficos para entender tus macros de forma r√°pida.</p>
        <div class="hero-buttons">
          <button class="btn" onclick="showSection('planes')">Ver Planes</button>
          <button class="btn secondary" onclick="showSection('diario')">Mi Diario</button>
        </div>
      </div>

      <div class="card">
        <h3>Panel r√°pido</h3>
        <p class="badge">IMC: <span id="imcValue">‚Äî</span></p>
        <p style="margin-top:8px">Objetivo: <strong id="selectedGoal">...</strong></p>
        <p style="margin-top:8px">Dieta seleccionada: <strong id="selectedDiet">...</strong></p>
        <p style="margin-top:8px">Plan seleccionado: <strong id="selectedPlan">...</strong></p>
        <div style="margin-top:12px">
          <button class="btn" id="saveProfile">Guardar M√©tricas</button>
          <button class="btn secondary" id="clearData">Borrar Todo</button>
        </div>
      </div>
    </section>

    <div class="col-12">
        <div id="tracker" class="card" data-aos="fade-up">
            <h3>Seguimiento de Hoy</h3>
            <div class="tracker-item">
                <input type="checkbox" id="track-water">
                <label for="track-water">Beb√≠ 2L de agua</label>
            </div>
            <div class="tracker-item">
                <input type="checkbox" id="track-workout">
                <label for="track-workout">Entren√© hoy</label>
            </div>
            <div class="tracker-item">
                <input type="checkbox" id="track-diet">
                <label for="track-diet">Segu√≠ mi dieta</label>
            </div>
            <hr style="border-color:var(--glass); margin: 12px 0;">
            <div class="form-row">
                <input type="number" id="track-calories" placeholder="Calor√≠as consumidas (ej: 1800)">
            </div>
            <button class="btn" style="width:100%" onclick="completeDay()">Completar D√≠a</button>
        </div>

        <div class="card" data-aos="fade-up">
          <h3>Asistente FitLifes¬°GO!</h3>
          <div class="chat">
            <div class="messages" id="messages"></div>
            <div class="chat-input">
              <input id="chatInput" placeholder="Preg√∫ntame algo..." />
              <button class="btn" onclick="sendMessage()">Enviar</button>
            </div>
          </div>
        </div>

        <div id="calculadora" class="card" data-aos="fade-up">
          <h3>Mis M√©tricas</h3>
          <p>Estos datos se usan para todas las calculadoras. Aj√∫stalos aqu√≠ o en el cuestionario.</p>
          <div>
            <div class="form-row">
              <input id="age" type="number" placeholder="Edad" />
              <select id="sex" onchange="toggleCustomGender('sex')">
                <option value="male">Hombre</option>
                <option value="female">Mujer</option>
                <option value="other">Otro</option>
              </select>
            </div>
            <div class="form-row">
              <input id="height" type="number" placeholder="Altura (cm)" />
              <input id="weight" type="number" placeholder="Peso (kg)" />
            </div>
            <div style="display:flex;gap:8px;margin-top:8px">
              <button class="btn" onclick="calculateCalories()">Calcular TMB</button>
              <button class="btn secondary" onclick="saveProfile()">Guardar</button>
            </div>
            <p style="margin-top:12px">Tu TMB estimada: <strong id="tmb">‚Äî</strong></p>
            <p>Calor√≠as objetivo: <strong id="targetCalories">‚Äî</strong></p>
          </div>
        </div>
    </div>


    <div class="grid">
      <div class="col-12">
        
        <div id="tutorial" class="card" data-aos="fade-up">
            <h3>Gu√≠a R√°pida: ¬°Empezar en 3 pasos!</h3>
            <div class="tutorial-step">
                <h4>1. Configura tu Perfil</h4>
                <p>Presiona <strong>"Mi Perfil"</strong> para abrir el cuestionario. Introduce tu nombre, edad, peso y, lo m√°s importante, tu <strong>objetivo</strong> (Perder, Mantener o Ganar). Esto calcula tus calor√≠as objetivo autom√°ticamente.</p>
            </div>
            <div class="tutorial-step">
                <h4>2. Elige tu Plan y Dieta</h4>
                <p>Ve a las secciones <strong>"Planes"</strong> y <strong>"Dietas"</strong> para seleccionar el que m√°s te convenga. Al seleccionarlos, se guardar√°n y aparecer√°n en tu "Panel R√°pido".</p>
            </div>
            <div class="tutorial-step">
                <h4>3. Rellena tu Diario</h4>
                <p>Usa el panel <strong>"Seguimiento de Hoy"</strong> (m√°s arriba) para marcar tus actividades y calor√≠as al final del d√≠a. Presiona <strong>"Completar D√≠a"</strong> y ver√°s tu entrada en el <strong>"Diario de Progreso"</strong>.</p>
            </div>
        </div>

        <div id="diario" class="card" data-aos="fade-up">
            <h3>Diario de Progreso</h3>
            <p>Aqu√≠ se guarda un resumen de tus actividades diarias y tu progreso de peso.</p>
            <div class="grid" style="align-items: start;">
                <div class="col-8">
                    <h4>Historial de Actividad</h4>
                    <div id="journal-log" class="journal-log">
                        <p>A√∫n no hay entradas. Completa tu d√≠a en el panel "Seguimiento de Hoy" para empezar.</p>
                    </div>
                </div>
                <div class="col-4">
                    <h4>Progreso de Peso</h4>
                    <canvas id="progressChart" height="140"></canvas>
                    <div style="margin-top:8px;display:flex;gap:8px">
                        <input id="pesoInput" type="number" placeholder="Peso (kg)" />
                        <button class="btn" onclick="addProgress()">A√±adir</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="planes" class="card" data-aos="fade-up">
          <h3>Planes de Entrenamiento (Todos Gratis)</h3>
          <div class="plans">
            <div class="plan">
              <h4>P√©rdida de peso</h4>
              <p>Entrenamientos HIIT, 4x por semana...</p>
              <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
                <div class="price">Gratis</div>
                <button class="btn secondary" onclick="showPlanDetails('weight_loss')">Ver m√°s</button>
              </div>
            </div>
            <div class="plan">
              <h4>Aumento muscular</h4>
              <p>Fuerza y volumen, 5x por semana...</p>
              <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
                <div class="price">Gratis</div>
                <button class="btn secondary" onclick="showPlanDetails('muscle_gain')">Ver m√°s</button>
              </div>
            </div>
            <div class="plan">
              <h4>Tonificaci√≥n</h4>
              <p>Combinaci√≥n cardio-fuerza, 3x...</p>
              <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px">
                <div class="price">Gratis</div>
                <button class="btn secondary" onclick="showPlanDetails('toning')">Ver m√°s</button>
              </div>
            </div>
          </div>
        </div>

        <div id="dietas" class="card" data-aos="fade-up">
          <h3>Planes de Dieta</h3>
          <div class="diet-list">
            <div class="diet-card card" data-diet="balanced">
              <div class="chart-wrap"><canvas id="chart-balanced" width="140" height="140"></canvas></div>
              <div class="diet-info">
                <h4>Balanceada</h4> <p>Macros: <span class="badge">P 30% ‚Ä¢ C 45% ‚Ä¢ G 25%</span></p>
                <div style="margin-top:8px">
                  <button class="btn" onclick="selectDiet('Balanceada', 'balanced')">Seleccionar</button>
                  <button class="btn secondary" onclick="showDietDetails('balanced')">Detalles</button>
                </div>
              </div>
            </div>
            <div class="diet-card card" data-diet="keto">
              <div class="chart-wrap"><canvas id="chart-keto" width="140" height="140"></canvas></div>
              <div class="diet-info">
                <h4>Cetog√©nica</h4> <p>Macros: <span class="badge">P 20% ‚Ä¢ C 10% ‚Ä¢ G 70%</span></p>
                <div style="margin-top:8px">
                  <button class="btn" onclick="selectDiet('Cetog√©nica', 'keto')">Seleccionar</button>
                  <button class="btn secondary" onclick="showDietDetails('keto')">Detalles</button>
                </div>
              </div>
            </div>
            <div class="diet-card card" data-diet="vegan">
              <div class="chart-wrap"><canvas id="chart-vegan" width="140" height="140"></canvas></div>
              <div class="diet-info">
                <h4>Vegana</h4> <p>Macros: <span class="badge">P 25% ‚Ä¢ C 55% ‚Ä¢ G 20%</span></p>
                <div style="margin-top:8px">
                  <button class="btn" onclick="selectDiet('Vegana', 'vegan')">Seleccionar</button>
                  <button class="btn secondary" onclick="showDietDetails('vegan')">Detalles</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="contacto" class="card" data-aos="fade-up">
          <h3>Contacto</h3>
          <form onsubmit="event.preventDefault();alert('Mensaje enviado (simulado)')">
            <div class="form-row">
              <input required placeholder="Nombre" />
              <input required placeholder="Correo" type="email" />
            </div>
            <textarea required placeholder="Mensaje" style="width:100%;min-height:100px;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit"></textarea>
            <div style="margin-top:10px"><button class="btn">Enviar</button></div>
          </form>
        </div>

        <div id="creditos" class="card" data-aos="fade-up">
            <h3>Cr√©ditos</h3>
            <p><strong>Escuela:</strong> CBTis N. 132, Hermosillo Sonora M√©xico</p>
            <p><strong>Desarrolladores:</strong></p>
            <ul>
                <li>Jonathan Alexis Payan Enriquez</li>
                <li>Sebastian Teran Rubio</li>
            </ul>
            <p><strong>Desarrollador Principal:</strong> Jesus Abraham Lopez Gutierrez</p>
        </div>
        
      </div>
    </div>
  </main>

  <footer>
    <p>¬© 2025 FitLifes¬°GO! ‚Ä¢ CBTis Fit App ‚Ä¢ Pol√≠tica de Privacidad</p>
  </footer>

  <div id="wizard-modal" class="modal-overlay">
    <div class="modal-content">
      <div id="step-1" class="wizard-step active">
          <h2 class="modal-header" style="color:var(--accent); padding:0; border:0;">¬°Bienvenido a FitLifes¬°GO!</h2>
          <p>Vamos a configurar tu perfil. Esto solo tomar√° un minuto y nos ayudar√° a personalizar tu experiencia.</p>
          <div class="wizard-nav">
              <span></span>
              <button class="btn" onclick="nextStep(2)">Comenzar</button>
          </div>
      </div>
      <div id="step-2" class="wizard-step">
          <h2 class="modal-header" style="color:var(--accent); padding:0; border:0;">¬øCu√°l es tu objetivo principal?</h2>
          <div class="wizard-options">
              <div class="option" id="goal-lose" onclick="selectWizardOption('goal', 'lose')">Perder Peso</div>
              <div class="option" id="goal-maintain" onclick="selectWizardOption('goal', 'maintain')">Mantener Peso</div>
              <div class="option" id="goal-gain" onclick="selectWizardOption('goal', 'gain')">Ganar M√∫sculo</div>
          </div>
          <div class="wizard-nav">
              <button class="btn secondary" onclick="prevStep(1)">Atr√°s</button>
              <button class="btn" onclick="nextStep(3)">Siguiente</button>
          </div>
      </div>
      <div id="step-3" class="wizard-step">
          <h2 class="modal-header" style="color:var(--accent); padding:0; border:0;">Cu√©ntanos sobre ti</h2>
          <p>Usaremos esto para calcular tus calor√≠as, IMC y TMB.</p>
          <div class="form-row">
              <input id="wiz-name" type="text" placeholder="Tu Nombre" />
              <select id="wiz-sex" onchange="toggleCustomGender('wiz-sex')">
                <option value="male">Hombre</option>
                <option value="female">Mujer</option>
                <option value="other">Otro</option>
              </select>
          </div>
          <input id="wiz-custom-gender" type="text" placeholder="¬øC√≥mo te identificas? (Opcional)" style="display:none; margin-bottom:10px;" />
          <div class="form-row">
              <input id="wiz-age" type="number" placeholder="Edad" />
              <input id="wiz-height" type="number" placeholder="Altura (cm)" />
              <input id="wiz-weight" type="number" placeholder="Peso (kg)" />
          </div>
          <div class="wizard-nav">
              <button class="btn secondary" onclick="prevStep(2)">Atr√°s</button>
              <button class="btn" onclick="nextStep(4)">Siguiente</button>
          </div>
      </div>
      <div id="step-4" class="wizard-step">
          <h2 class="modal-header" style="color:var(--accent); padding:0; border:0;">Tu Estilo de Vida</h2>
          <p>Nivel de Actividad F√≠sica:</p>
          <select id="wiz-activity" style="width:100%; margin-bottom: 12px;">
              <option value="1.2">Sedentario (poco o nada)</option>
              <option value="1.375">Ligero (1-3 d√≠as/semana)</option>
              <option value="1.55">Moderado (3-5 d√≠as/semana)</option>
              <option value="1.725">Activo (6-7 d√≠as/semana)</option>
              <option value="1.9">Muy activo (trabajo f√≠sico + ejercicio)</option>
          </select>
          <p>Preferencia de Dieta (Opcional):</p>
          <select id="wiz-diet" style="width:100%">
              <option value="">Ninguna en especial</option>
              <option value="balanced">Balanceada</option>
              <option value="keto">Cetog√©nica</option>
              <option value="vegan">Vegana</option>
          </select>
          <div class="wizard-nav">
              <button class="btn secondary" onclick="prevStep(3)">Atr√°s</button>
              <button class="btn" onclick="completeWizard()">Finalizar</button>
          </div>
      </div>
    </div>
  </div>

  <div id="details-modal" class="modal-overlay">
    </div>

  <div id="mobile-menu-overlay" class="modal-overlay">
    </div>
  
  <div id="mobile-nav-tabs">
      <button class="tab-btn active" data-section="tutorial"><i class="fa-solid fa-graduation-cap"></i> Gu√≠a</button>
      <button class="tab-btn" data-section="planes"><i class="fa-solid fa-weight-hanging"></i> Planes</button>
      <button class="tab-btn" data-section="dietas"><i class="fa-solid fa-apple-whole"></i> Dietas</button>
      <button class="tab-btn" data-section="diario"><i class="fa-solid fa-book"></i> Diario</button>
      <button class="tab-btn" data-section="creditos"><i class="fa-solid fa-medal"></i> Cr√©ditos</button>
  </div>


<script>
  // ====================
  // Base de datos (Mock)
  // ====================
  const DATABASE = {
      plans: {
          'weight_loss': { title: 'Plan: P√©rdida de peso', details: `<h3>Rutina Semanal (Ejemplo)</h3><ul><li><strong>Lunes:</strong> HIIT Total (30 min)</li><li><strong>Mi√©rcoles:</strong> Foco Abdomen y Piernas (40 min)</li><li><strong>Viernes:</strong> HIIT Cardio Intenso (35 min)</li><li><strong>S√°bado:</strong> Full Body Strength (45 min)</li></ul>`},
          'muscle_gain': { title: 'Plan: Aumento muscular', details: `<h3>Rutina Semanal (Ejemplo)</h3><ul><li><strong>Lunes:</strong> Pecho y Tr√≠ceps</li><li><strong>Martes:</strong> Espalda y B√≠ceps</li><li><strong>Mi√©rcoles:</strong> Piernas</li><li><strong>Viernes:</strong> Hombros y Trapecio</li><li><strong>S√°bado:</strong> Full Body</li></ul>`},
          'toning': { title: 'Plan: Tonificaci√≥n', details: `<h3>Rutina Semanal (Ejemplo)</h3><ul><li><strong>D√≠a 1:</strong> Full Body A + 15 min Cardio</li><li><strong>D√≠a 3:</strong> Full Body B + 15 min HIIT</li><li><strong>D√≠a 5:</strong> Full Body C + 20 min Cardio</li></ul>`}
      },
      diets: {
          'balanced': { title: 'Dieta Balanceada', macros: 'P 30% ‚Ä¢ C 45% ‚Ä¢ G 25%', details: `<h3>Ejemplo de Men√∫ (1 D√≠a)</h3><ul><li><strong>Desayuno:</strong> Avena con frutas y prote√≠na.</li><li><strong>Comida:</strong> Pollo a la plancha con quinoa y ensalada.</li><li><strong>Cena:</strong> Salm√≥n al horno con batata y br√≥coli.</li></ul>`},
          'keto': { title: 'Dieta Cetog√©nica', macros: 'P 20% ‚Ä¢ C 10% ‚Ä¢ G 70%', details: `<h3>Ejemplo de Men√∫ (1 D√≠a)</h3><ul><li><strong>Desayuno:</strong> Huevos revueltos con aguacate.</li><li><strong>Comida:</strong> Ensalada de ternera, aceite de oliva y nueces.</li><li><strong>Cena:</strong> Muslos de pollo al curry con coliflor.</li></ul>`},
          'vegan': { title: 'Dieta Vegana', macros: 'P 25% ‚Ä¢ C 55% ‚Ä¢ G 20%', details: `<h3>Ejemplo de Men√∫ (1 D√≠a)</h3><ul><li><strong>Desayuno:</strong> Tofu revuelto con pan integral.</li><li><strong>Comida:</strong> Bol de garbanzos, lentejas y arroz.</li><li><strong>Cena:</strong> Curry de lentejas rojas y espinacas.</li></ul>`}
      }
  };

  // Variables globales
  let wizardData = { goal: 'maintain' };
  
  // ==================== AOS init ====================
  AOS.init({once:true, duration:700});

  // ====================
  // L√≥gica del Cuestionario (Wizard)
  // ====================
  const wizardModal = document.getElementById('wizard-modal');
  
  function showWizard() {
      wizardModal.classList.add('visible');
      goToStep(1);
  }
  function closeWizard() {
      wizardModal.classList.remove('visible');
  }
  function goToStep(stepNum) {
      document.querySelectorAll('#wizard-modal .wizard-step').forEach(s => s.classList.remove('active'));
      document.getElementById('step-' + stepNum).classList.add('active');
  }
  function nextStep(stepNum) { goToStep(stepNum); }
  function prevStep(stepNum) { goToStep(stepNum); }

  function selectWizardOption(key, value) {
      wizardData[key] = value;
      const group = key === 'goal' ? 'goal' : '';
      if(group) {
          document.querySelectorAll(`.wizard-options .option[id^="${group}-"]`).forEach(o => o.classList.remove('selected'));
          document.getElementById(`${group}-${value}`).classList.add('selected');
      }
  }

  /**
   * NUEVO: Muestra/Oculta el campo de g√©nero personalizado
   * @param {string} selectId - ID del elemento select (p. ej., 'wiz-sex' o 'sex')
   */
  function toggleCustomGender(selectId) {
      const select = document.getElementById(selectId);
      const customInput = document.getElementById('wiz-custom-gender');
      
      if (selectId === 'wiz-sex') {
          if (select.value === 'other') {
              customInput.style.display = 'block';
          } else {
              customInput.style.display = 'none';
              customInput.value = ''; // Limpiar si se deselecciona
          }
      }
  }

  function completeWizard() {
      const name = document.getElementById('wiz-name').value;
      const age = document.getElementById('wiz-age').value;
      const height = document.getElementById('wiz-height').value;
      const weight = document.getElementById('wiz-weight').value;
      const sex = document.getElementById('wiz-sex').value;
      const customGender = document.getElementById('wiz-custom-gender').value;
      const activity = document.getElementById('wiz-activity').value;
      const dietId = document.getElementById('wiz-diet').value;

      if (!name || !age || !height || !weight) {
          return alert('Por favor, completa tu nombre, edad, altura y peso.');
      }

      localStorage.setItem('fitlife_user', JSON.stringify({ name }));
      const profile = { age, height, weight, sex, customGender, activity, goal: wizardData.goal };
      localStorage.setItem('fitlife_profile', JSON.stringify(profile));
      
      if(dietId) {
          const dietName = DATABASE.diets[dietId]?.title || 'Balanceada';
          selectDiet(dietName, dietId, true); // true para silenciar el alert
      }

      closeWizard();
      alert(`¬°Bienvenido, ${name}! Tu perfil de FitLifes¬°GO! est√° configurado.`);
      loadProfile();
      welcomeAssistant();
      showSection('tutorial'); // Mostrar el tutorial al terminar el wizard
  }


  // ====================
  // L√≥gica de Perfil y Carga
  // ====================
  function saveProfile(){
    const age = document.getElementById('age').value;
    const height = document.getElementById('height').value;
    const weight = document.getElementById('weight').value;
    const sex = document.getElementById('sex').value;
    // En el perfil r√°pido no hay campo para customGender, solo se usa el select.
    if(!age || !height || !weight){ return alert('Por favor, completa edad, altura y peso para guardar.'); }
    
    const p = JSON.parse(localStorage.getItem('fitlife_profile') || '{}');
    p.age = age;
    p.height = height;
    p.weight = weight;
    p.sex = sex;
    
    localStorage.setItem('fitlife_profile', JSON.stringify(p));
    alert('M√©tricas guardadas');
    loadProfile();
  }
  document.getElementById('saveProfile').addEventListener('click', saveProfile);
  document.getElementById('clearData').addEventListener('click', ()=>{
      if(confirm('¬øEst√°s seguro de que quieres borrar todos tus datos guardados (perfil, progreso, diario)?')){
          localStorage.clear();
          location.reload();
      }
  });

  function loadProfile() {
      const p = JSON.parse(localStorage.getItem('fitlife_profile') || 'null');
      if(p){ 
          document.getElementById('age').value = p.age; 
          document.getElementById('height').value = p.height; 
          document.getElementById('weight').value = p.weight; 
          document.getElementById('sex').value = p.sex;
          
          // Cargar datos en el perfil r√°pido y calculadora.
          document.getElementById('selectedGoal').textContent = p.goal ? (p.goal.charAt(0).toUpperCase() + p.goal.slice(1)) : 'No definido';
          
          calculateIMC(); 
          calculateCalories(p.activity, p.goal);
      }

      const d = JSON.parse(localStorage.getItem('fitlife_selected_diet') || 'null'); 
      if(d) document.getElementById('selectedDiet').textContent = d.name;
      else document.getElementById('selectedDiet').textContent = 'Ninguna';

      const p_plan = JSON.parse(localStorage.getItem('fitlife_selected_plan') || 'null');
      if(p_plan) document.getElementById('selectedPlan').textContent = p_plan.name;
      else document.getElementById('selectedPlan').textContent = 'Ninguno';
  }

  // ====================
  // L√≥gica de C√°lculos (IMC, TMB, Calor√≠as)
  // ====================
  function calculateIMC(){
    const w = parseFloat(document.getElementById('weight').value);
    const h = parseFloat(document.getElementById('height').value)/100;
    const el = document.getElementById('imcValue');
    if(!w || !h){ el.textContent = '‚Äî'; return }
    const imc = (w/(h*h)).toFixed(1);
    el.textContent = imc;
  }
  document.getElementById('weight').addEventListener('input', calculateIMC);
  document.getElementById('height').addEventListener('input', calculateIMC);

  function calculateCalories(activity_val = null, goal_val = null){
    const age = Number(document.getElementById('age').value);
    const height = Number(document.getElementById('height').value);
    const weight = Number(document.getElementById('weight').value);
    const sex = document.getElementById('sex').value;
    
    const p = JSON.parse(localStorage.getItem('fitlife_profile') || 'null');
    const activity = activity_val || (p ? p.activity : 1.375);
    const goal = goal_val || (p ? p.goal : 'maintain');
    
    if(!age||!height||!weight){
        document.getElementById('tmb').textContent = '‚Äî';
        document.getElementById('targetCalories').textContent = '‚Äî';
        return;
    }
    let tmb = 0;
    if(sex==='male') tmb = 10*weight + 6.25*height - 5*age + 5;
    else tmb = 10*weight + 6.25*height - 5*age - 161;
    const maintenance = Math.round(tmb * activity);
    let target = maintenance;
    if(goal==='lose') target = Math.round(maintenance - 500);
    if(goal==='gain') target = Math.round(maintenance + 400);
    document.getElementById('tmb').textContent = Math.round(tmb) + ' kcal';
    document.getElementById('targetCalories').textContent = target + ' kcal';
  }

  // ====================
  // Gr√°ficos y Progreso
  // ====================
  function makeDoughnut(ctxId, data, labels, colors){ /* ... */ }
  let chartBalanced = makeDoughnut('chart-balanced',[30,45,25],['Prote√≠nas','Carbohidratos','Grasas'],['#3b82f6','#fb923c','#10b981']);
  let chartKeto = makeDoughnut('chart-keto',[20,10,70],['Prote√≠nas','Carbohidratos','Grasas'],['#3b82f6','#fb923c','#10b981']);
  let chartVegan = makeDoughnut('chart-vegan',[25,55,20],['Prote√≠nas','Carbohidratos','Grasas'],['#3b82f6','#fb923c','#10b981']);

  const ctxP = document.getElementById('progressChart').getContext('2d');
  const savedProgress = JSON.parse(localStorage.getItem('fitlife_progress') || '[]');
  const progressChart = new Chart(ctxP, {type:'line',data:{labels:savedProgress.map(p=>p.date),datasets:[{label:'Peso (kg)',data:savedProgress.map(p=>p.weight),fill:false,tension:0.3, borderColor: 'var(--accent)'}]},options:{responsive:true,plugins:{legend:{display:false}}}});

  function addProgress(){
    const val = Number(document.getElementById('pesoInput').value); if(!val) return alert('Introduce un peso');
    const arr = JSON.parse(localStorage.getItem('fitlife_progress') || '[]');
    const now = new Date(); const label = now.toLocaleDateString();
    arr.push({date:label,weight:val});
    localStorage.setItem('fitlife_progress', JSON.stringify(arr));
    progressChart.data.labels.push(label); progressChart.data.datasets[0].data.push(val); progressChart.update();
    document.getElementById('pesoInput').value='';
    document.getElementById('weight').value = val;
    saveProfile();
  }
  
  // ====================
  // Asistente FitLifes¬°GO! (NUEVO)
  // ====================
  const messagesEl = document.getElementById('messages');
  function appendMessage(text, who='bot'){
    const d = document.createElement('div'); d.className='msg '+(who==='user'?'user':'bot'); d.textContent=text; messagesEl.appendChild(d); messagesEl.scrollTop = messagesEl.scrollHeight;
  }
  function sendMessage(){
    const input = document.getElementById('chatInput'); const text = input.value.trim(); if(!text) return;
    appendMessage(text,'user'); input.value='';
    
    setTimeout(()=>{
      const t = text.toLowerCase();
      const p = JSON.parse(localStorage.getItem('fitlife_profile') || 'null');
      const goal = p ? p.goal : 'maintain';

      let response = 'Lo siento, no entend√≠ eso. Pregunta algo sobre tu dieta, entrenamiento o progreso. Por ejemplo: "¬øQu√© plan es el mejor para m√≠?"';

      if(t.includes('dieta') || t.includes('recomi')) {
          if (goal === 'lose') response = 'Como tu objetivo es perder peso, enf√≥cate en un d√©ficit cal√≥rico. La Dieta Cetog√©nica (baja en carbos) o una Balanceada baja en calor√≠as son buenas opciones. ¬°Revisa la secci√≥n "Dietas"!';
          else if (goal === 'gain') response = 'Para ganar m√∫sculo, necesitas un super√°vit cal√≥rico y consumir mucha prote√≠na. La Dieta Balanceada, ajustando las porciones para m√°s calor√≠as, es ideal para ti.';
          else response = 'Para mantenerte, una Dieta Balanceada es perfecta. Calcula tus calor√≠as de mantenimiento en el panel "Mis M√©tricas" y s√≠guelas.';
      }
      else if(t.includes('entrenar') || t.includes('ejercicio')) {
          if (goal === 'lose') response = 'Combina el entrenamiento de fuerza (para proteger el m√∫sculo) con mucho cardio (HIIT o de larga duraci√≥n).';
          else if (goal === 'gain') response = 'Enf√≥cate en levantamiento de pesas con sobrecarga progresiva (aumentar peso o repeticiones cada semana). Descansa bien y come mucha prote√≠na.';
          else response = 'El entrenamiento de tonificaci√≥n o un plan de 3 d√≠as full-body te ayudar√°n a mantenerte fuerte y en forma. ¬°No olvides el cardio!';
      }
      else if(t.includes('brazo') || t.includes('pecho')) response = 'Para el tren superior: curls de b√≠ceps, press de banca, fondos y elevaciones laterales. Recuerda calentar bien.';
      else if(t.includes('pierna') || t.includes('gluteo')) response = 'Para el tren inferior: sentadillas, peso muerto rumano, desplantes y prensa. Son cruciales para quemar m√°s calor√≠as y construir una base s√≥lida.';
      else if(t.includes('calor') || t.includes('calor√≠a')) response = 'Tus calor√≠as objetivo se calculan autom√°ticamente en el panel "Mis M√©tricas" bas√°ndose en tu perfil y objetivo. Es la cantidad que debes consumir al d√≠a.';
      else if(t.includes('agua') || t.includes('hidrat')) response = '¬°El agua es vital! Intenta beber al menos 2-3 litros al d√≠a. El seguimiento en "Mi D√≠a" te recordar√° el objetivo de 2L.';
      else if(t.includes('descanso') || t.includes('dormir')) response = 'El descanso es tan importante como el entrenamiento. Intenta dormir 7-9 horas por noche; sin buen descanso, el m√∫sculo no se recupera ni crece.';
      else if(t.includes('progres') || t.includes('diario')) response = 'Puedes registrar tu peso en el panel "Diario de Progreso" y tus actividades diarias en el panel "Seguimiento de Hoy". Todo se guarda autom√°ticamente.';

      appendMessage(response);
    },600);
  }
  document.getElementById('chatInput').addEventListener('keydown', (e)=>{ if(e.key==='Enter') sendMessage(); });

  function welcomeAssistant() {
      messagesEl.innerHTML = '';
      const u = JSON.parse(localStorage.getItem('fitlife_user') || 'null');
      const p = JSON.parse(localStorage.getItem('fitlife_profile') || 'null');
      let name = u ? u.name : 'Hola';
      let goal_msg = p ? ` Veo que tu objetivo es ${p.goal === 'lose' ? 'perder peso' : (p.goal === 'gain' ? 'ganar m√∫sculo' : 'mantenerte')}.` : '';
      
      appendMessage(`${name} üëã. Soy tu Asistente FitLifes¬°GO!${goal_msg} ¬øEn qu√© te ayudo hoy?`);
  }

  // ====================
  // L√≥gica del Diario y Seguimiento
  // ====================
  const journalLogEl = document.getElementById('journal-log');
  
  function loadJournal() { /* ... (la funci√≥n se mantiene) ... */ }
  function completeDay() { /* ... (la funci√≥n se mantiene) ... */ }


  // ====================
  // L√≥gica de Carga Inicial y Controles
  // ====================
  const themeToggle = document.getElementById('themeToggle');

  // Determinar si la vista es m√≥vil (para activar el sistema de tabs)
  const isMobile = window.matchMedia("(max-width: 900px)").matches;
  const mainSections = document.querySelectorAll('#tutorial, #diario, #planes, #dietas, #contacto, #creditos');


  /**
   * NUEVO: Muestra una secci√≥n espec√≠fica (para navegaci√≥n de escritorio y tabs de m√≥vil)
   * @param {string} sectionId - ID de la secci√≥n a mostrar
   */
  function showSection(sectionId) {
      // 1. Desactivar todos los activos
      mainSections.forEach(s => s.classList.remove('mobile-active-section'));
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));

      // 2. Activar la secci√≥n pedida
      const targetSection = document.getElementById(sectionId);
      if (targetSection) {
          targetSection.classList.add('mobile-active-section');
          // Desplazarse a la secci√≥n si es una vista m√≥vil
          if (isMobile) {
              window.scrollTo({ top: document.getElementById('tracker').offsetTop, behavior: 'smooth' });
          } else {
              targetSection.scrollIntoView({behavior:'smooth'})
          }
      }

      // 3. Activar el bot√≥n de la tab (solo si existe)
      const tabButton = document.querySelector(`.tab-btn[data-section="${sectionId}"]`);
      if (tabButton) {
          tabButton.classList.add('active');
      }
  }


  window.addEventListener('load', ()=>{
    // Cargar Tema
    const savedTheme = localStorage.getItem('fitlife_theme') || 'dark';
    document.body.setAttribute('data-theme', savedTheme);
    themeToggle.innerHTML = savedTheme === 'light' ? '<i class="fa-solid fa-sun"></i>' : '<i class="fa-solid fa-moon"></i>';

    const p = JSON.parse(localStorage.getItem('fitlife_profile') || 'null');
    if(p) {
        loadProfile();
        closeWizard();
        welcomeAssistant();
        showSection('tutorial'); // Muestra la gu√≠a r√°pida al inicio si el perfil ya existe
    } else {
        showWizard();
    }

    const prog = JSON.parse(localStorage.getItem('fitlife_progress') || '[]');
    if(prog.length){ 
        progressChart.data.labels = prog.map(p=>p.date); 
        progressChart.data.datasets[0].data = prog.map(p=>p.weight); 
        progressChart.update(); 
    }

    loadJournal();

    // NUEVO: Manejo de clics en la navegaci√≥n de escritorio
    document.querySelectorAll('.desktop-nav a').forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const sectionId = e.target.getAttribute('href').replace('#', '');
            showSection(sectionId);
        });
    });

    // NUEVO: Manejo de clics en las tabs m√≥viles
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const sectionId = btn.getAttribute('data-section');
            showSection(sectionId);
        });
    });

    // Si es m√≥vil, la secci√≥n inicial es 'tutorial', si no, todas son visibles por el CSS de escritorio.
    if (!isMobile) {
        mainSections.forEach(s => s.classList.add('mobile-active-section'));
    }

    // Asegurar que el tutorial est√© visible por defecto si el perfil ya existe y es m√≥vil.
    if (isMobile && p) {
        showSection('tutorial');
    }
  });

  // Control de Tema
  function toggleTheme() { /* ... (la funci√≥n se mantiene) ... */ }
  themeToggle.addEventListener('click', toggleTheme);

  // Control de Perfil
  const openRegister = document.getElementById('openRegister');
  openRegister.addEventListener('click', ()=>{
      const p = JSON.parse(localStorage.getItem('fitlife_profile') || 'null');
      if (p) {
          // Llenar campos del wizard con datos guardados
          document.getElementById('wiz-name').value = JSON.parse(localStorage.getItem('fitlife_user') || '{}').name || '';
          document.getElementById('wiz-sex').value = p.sex;
          document.getElementById('wiz-age').value = p.age;
          document.getElementById('wiz-height').value = p.height;
          document.getElementById('wiz-weight').value = p.weight;
          document.getElementById('wiz-activity').value = p.activity;
          
          if (p.sex === 'other' && p.customGender) {
              document.getElementById('wiz-custom-gender').value = p.customGender;
              document.getElementById('wiz-custom-gender').style.display = 'block';
          } else {
              document.getElementById('wiz-custom-gender').style.display = 'none';
          }
          
          selectWizardOption('goal', p.goal);
          const d = JSON.parse(localStorage.getItem('fitlife_selected_diet') || 'null');
          if (d) document.getElementById('wiz-diet').value = d.id;
      }
      showWizard();
  });
  
  // ====================
  // L√≥gica de Modales y Men√∫ M√≥vil
  // ====================
  // Se mantienen las funciones showPlanDetails, showDietDetails, closeDetailsModal, selectDiet, selectPlan.
  // Tambi√©n las funciones de apertura/cierre de Men√∫ M√≥vil.
  // (Debido a la longitud, se omite el c√≥digo JS sin cambios en esta respuesta, pero debe estar en el HTML final).
</script>
</body>
</html>
